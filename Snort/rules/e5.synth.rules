
############################################################################################################
## OP/SHELLCODE DETECTION - 
## NOTE:  Shellcode ports should be: var SHELLCODE_PORTS   [!80,!8080,!443,!22]
############################################################################################################
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 0xEB0C NOOP";  content:"|EB 0C EB 0C EB 0C EB 0C EB 0C EB 0C EB 0C EB 0C|"; classtype:shellcode-detect; sid:599910; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 stealth NOOP"; content:"|EB 02 EB 02 EB 02|"; reference:arachnids,291; classtype:shellcode-detect; sid:599905; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 NOOP"; content:"aaaaaaaaaaaaaaaaaaaaa"; classtype:shellcode-detect; sid:599909; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 0x71FB7BAB NOOP"; content:"q|FB|{|AB|q|FB|{|AB|q|FB|{|AB|q|FB|{|AB|"; classtype:shellcode-detect; sid:599911; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 inc ebx NOOP"; content:"CCCCCCCCCCCCCCCCCCCCCCCC"; classtype:shellcode-detect; sid:599998; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE sparc setuid 0"; content:"|82 10| |17 91 D0| |08|"; reference:arachnids,282; classtype:shellcode-detect; sid:599901; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 setgid 0";   content:"|B0 B5 CD 80|"; reference:arachnids,284; classtype:shellcode-detect; sid:599902; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 setuid 0";   content:"|B0 17 CD 80|"; reference:arachnids,436; classtype:shellcode-detect; sid:599903; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE Linux shellcode"; content:"|90 90 90 E8 C0 FF FF FF|/bin/sh"; reference:arachnids,343; classtype:shellcode-detect; sid:599907; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] SHELLCODE x86 0x71FB7BAB NOOP unicode"; content:"q|00 FB 00|{|00 AB 00|q|00 FB 00|{|00 AB 00|q|00 FB 00|{|00 AB 00|q|00 FB 00|{|00 AB 00|"; classtype:shellcode-detect; sid:599912; rev:1;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445]      (msg:"E5[rb] BLEEDING-EDGE EXPLOIT LSA exploit"; content:"|3131313131313131313131313131313131313131313131|";  classtype:attempted-admin; reference:url,www.eeye.com/html/research/advisories/AD20040501.html; reference:url,www.upenn.edu/computing/virus/04/w32.sasser.worm.html; sid:592000032; rev:99; )
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET [135:139,445,1025] (msg:"E5[rb] ET SHELLCODE x86 0x90 unicode NOOP"; content:"|90 90 90 90 90 90 90 90 90 90|"; classtype:shellcode-detect; sid:5299913; rev:1;)

alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET 139 (msg:"E5[rb] ET VIRUS BugBear@MM Worm Copied to Startup Folder"; flow: established; content:"|77 00 69 00 6B 00 2E 00 65 00 78 00 65 00 00 00|"; reference:url,www.symantec.com/avcenter/venc/data/w32.bugbear@mm.html; classtype:shellcode-detect; sid:52001766; rev:5;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET WORM W32/Sasser.worm.b"; flow: established; content:"|58 BC 0C FF 59 57 32 31 BD EC 34 64 6E D6 E3 8D 65 04 68 58 62 79 DF D8 2C 25 6A B5 28 BA 13 74|"; reference:url,securityresponse.symantec.com/avcenter/venc/data/w32.sasser.worm.html; classtype:shellcode-detect; sid:52001056; rev:6;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET WORM W32/Sasser.worm.a"; flow: established; content:"|BC 3B 74 0B 50 8B 3D E8 46 A7 3D 09 85 B8 F8 CD 76 40 DE 7C 5B 5C D7 2A A8 E8 58 75 62 96 25 24|"; reference:url,securityresponse.symantec.com/avcenter/venc/data/w32.sasser.worm.html; classtype:shellcode-detect; sid:52001057; rev:6;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT x86 Alpha2 GetEIPs Encoder"; content:"|EB 03 59 EB 05 E8 F8 FF FF FF|"; classtype:shellcode-detect; sid:52002904; rev:2;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT x86 Countdown Encoder";content:"|E8 FF FF FF FF C1 5E 30 4C 0E 07 E2 FA|";classtype:shellcode-detect; sid:52002905; rev:2;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT x86 PexAlphaNum Encoder"; content:"VTX630VXH49HHHPhYAAQhZYYYYAAQQDDDd36FFFFTXVj0PPTUPPa301089"; content:"JJJJJ"; distance: 2; within: 5; content:"VTX630VX4A0B6HH0B30BCVX2BDBH4A2AD0ADTBDQB0ADAVX4Z8BDJOM"; distance: 2; within: 55; classtype:shellcode-detect; sid:52002906; rev:2;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT x86 PexFnstenvMov/Sub Encoder"; content:"|D9 EE D9 74 24 F4 5B 81 73 13|"; content:"|83 EB FC E2 F4|"; distance: 4; within: 5; classtype:shellcode-detect; sid:52002903; rev:2;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT x86 JmpCallAdditive Encoder"; content:"|FC BB|"; content:"|EB 0C 5E 56 31 1E AD 01 C3 85 C0 75 F7 C3 E8 EF FF FF FF|"; distance: 4; within: 19; classtype:shellcode-detect; sid:52002908; rev:2;)
alert tcp $HOME_NET $SHELLCODE_PORTS -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT x86 PexCall Encoder"; content:"|E8 FF FF FF FF C0 5E 81 76 0E|"; content:"|82 EE FC E2 F4|"; distance: 4; within: 5; classtype:shellcode-detect; sid:52002907; rev:2;)

############################################################################################################
## Web Applications Attack
############################################################################################################
alert tcp $HOME_NET 110 -> $EXTERNAL_NET any  (msg:"E5[rb] ET EXPLOIT Possible Sun Java Plugin arbitrary package access exploit (3)"; flow:to_client; content:"|2e|getClass|28|"; content:"|2e|forName|28|"; distance:0; within:30; reference:url,jouko.iki.fi/adv/javaplugin.html; reference:url,sunsolve.sun.com/search/document.do?assetkey=1-26-57591-1; reference:url,www.idefense.com/application/poi/display?id=158; reference:url,archives.neohapsis.com/archives/bugtraq/2004-11/0299.html; reference:url,secunia.com/advisories/13271/; reference:url,www.kb.cert.org/vuls/id/760344; reference:cve,CAN-2004-1029; classtype:web-application-attack; sid:52001551; rev:7;)
alert tcp $HOME_NET 143 -> $EXTERNAL_NET any  (msg:"E5[rb] ET EXPLOIT Possible Sun Java Plugin arbitrary package access exploit (4)"; flow:to_client; content:"|2e|getClass|28|"; content:"|2e|forName|28|"; distance:0; within:30; reference:url,jouko.iki.fi/adv/javaplugin.html; reference:url,sunsolve.sun.com/search/document.do?assetkey=1-26-57591-1; reference:url,www.idefense.com/application/poi/display?id=158; reference:url,archives.neohapsis.com/archives/bugtraq/2004-11/0299.html; reference:url,secunia.com/advisories/13271/; reference:url,www.kb.cert.org/vuls/id/760344; reference:cve,CAN-2004-1029; classtype:web-application-attack; sid:52001552; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 2775 (msg:"E5[rb] ET EXPLOIT Now SMS/MMS Gateway SMPP BOF Vulnerability"; flow:established,to_server; content:"|00 00 00 04|"; content:"|00 00 00 01|"; distance:1; pcre:"/[a-zA-Z0-9]{1000,}/i"; reference:bugtraq,27896; reference:url,aluigi.altervista.org/adv/nowsmsz-adv.txt; classtype:web-application-attack; sid:52007875; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3443 (msg:"E5[rb] ET WEB HP OpenView Network Node Manager Remote Command Execution Attempt"; flow: to_server,established; uricontent:"/OvCgi/connectedNodes.ovpl?"; nocase; pcre:"/node=.*\|.+\|/i"; reference:bugtraq,14662; classtype: web-application-attack; sid:52002365; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5250 (msg:"E5[rb] ET EXPLOIT MISC Computer Associates Negative Content-Length Buffer Overflow"; flow:established,to_server; content:"Content-Length|3A|"; nocase; pcre:"/^Content-Length\x3a\s*-\d+/smi"; reference:bugtraq,16354; reference:cve,2005-3653; classtype:web-application-attack; sid:52002791; rev:3;) 
alert tcp $HOME_NET any -> $EXTERNAL_NET 8028 (msg:"E5[rb] ET EXPLOIT Novell HttpStk Remote Code Execution Attempt /dhost (linewrap)"; flow:to_server,established; content:"/dhost"; depth:10; nocase; content:"|0d0a|Host|3a|"; nocase; content:"|0d0a20|"; within:56; classtype:web-application-attack; sid:52003147; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8028 (msg:"E5[rb] ET EXPLOIT Novell HttpStk Remote Code Execution Attempt /dhost"; flow:to_server,established; content:"/dhost"; depth:10; nocase; content:"|0d0a|Host|3a|"; nocase; content:!"|0d0a|"; within:56; classtype:web-application-attack; sid:52003146; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8028 (msg:"E5[rb] ET EXPLOIT Novell HttpStk Remote Code Execution Attempt /nds (linewrap)"; flow:to_server,established; content:"/nds"; depth:10; nocase; content:"|0d0a|Host|3a|"; nocase; content:"|0d0a20|"; within:56; classtype:web-application-attack; sid:52003148; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8028 (msg:"E5[rb] ET EXPLOIT Novell HttpStk Remote Code Execution Attempt /nds"; flow:to_server,established; content:"/nds"; depth:10; nocase; content:"|0d0a|Host|3a|"; nocase; content:!"|0d0a|"; within:56; classtype:web-application-attack; sid:52003145; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8800 (msg:"E5[rb] ET EXPLOIT Now SMS/MMS Gateway HTTP BOF Vulnerability"; flow:established,to_server; content:"GET "; depth:4; content:"Basic"; nocase; pcre:"/[a-zA-Z0-9]{255,}==/i"; reference:bugtraq,27896; reference:url,aluigi.altervista.org/adv/nowsmsz-adv.txt; classtype:web-application-attack; sid:52007874; rev:2;)

############################################################################################################
## Trojan Activity
############################################################################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET 22           (msg:"E5[rb] REGISTERED FREE gobbles SSH exploit attempt"; flow:to_server,established; content:"GOBBLES"; reference:bugtraq,5093; reference:cve,11031; reference:cve,2002-0390; reference:cve,2002-0639; classtype:trojan-activity; sid:51812; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445]    (msg:"E5[rb] ET EXPLOIT NETBIOS SMB-DS DCERPC NetrpPathCanonicalize request (possible MS06-040)"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB|25|"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00|"; within:9; distance:4; content:"|1f 00|"; distance:20; within:2; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:trojan-activity; sid:52003082; rev:4;)
alert tcp $HOME_NET 1024: -> $EXTERNAL_NET 1024:      (msg:"E5[rb] ET TROJAN Srizbi requesting template"; flow:established,to_server; content:"GET|20|/"; depth:5; content:"|0d0a|X-Flags|3a20|";  within:200; content:"|0d0a|X-TM|3a20|"; within:20;  content:"|0d0a|X-BI|3a20|"; within:20; reference:url,www.secureworks.com/research/threats/ronpaul/; classtype:trojan-activity; sid:52007712; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3127:3198    (msg:"E5[rb] REGISTERED FREE BACKDOOR mydoom.a backdoor upload/execute attempt"; flow:to_server,established; content:"|85 13|<|9E A2|"; depth:5; classtype:trojan-activity; sid:53272; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3127:3199    (msg:"E5[rb] REGISTERED FREE BACKDOOR DoomJuice file upload attempt"; flow:to_server,established; content:"|85 13|<|9E A2|"; depth:5; reference:url,securityresponse.symantec.com/avcenter/venc/data/w32.hllw.doomjuice.html; classtype:trojan-activity; sid:52375; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] ET MALWARE /jk/exp.wmf Exploit Code Load Attempt"; flow:to_server,established; uricontent:"/jk/exp.wmf"; nocase; classtype:trojan-activity; sid:52002999; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] ET MALWARE Speed-runner.com Fake Speed Test User-Agent (SRInstaller)"; flow:to_server,established; content:"|0d 0a|User-Agent\: SRInstaller|0d 0a|"; classtype:trojan-activity; sid:52008145; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] ET MALWARE Speed-runner.com Fake Speed Test User-Agent (SpeedRunner)"; flow:to_server,established; content:"|0d 0a|User-Agent\: SpeedRunner|0d 0a|"; classtype:trojan-activity; sid:52008146; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] ET MALWARE Suspicious User Agent - Likely Webhancer Related Spyware (TEST)"; flow:to_server,established; content:"User-Agent\: TEST|0d 0a|"; classtype:trojan-activity; sid:52006357; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] ET TROJAN Prg Trojan HTTP POST v1"; flow:established,to_server; content:"POST "; depth:5; uricontent:".php?2="; uricontent:"&n="; uricontent:"&v="; uricontent:"&i="; uricontent:"&sp="; uricontent:"&lcp="; reference:url,www.securescience.net/FILES/securescience/10378/pubMalwareCaseStudy.pdf; classtype:trojan-activity; sid:52007688; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] ET TROJAN Prg Trojan HTTP POST version 2"; flow:established,to_server; content:"POST "; depth:5; uricontent:".php?1="; uricontent:"&i="; pcre:"/\.php\?1=[a-z0-9]+_[a-z0-9_]+&i=/Ui"; reference:url,www.securescience.net/FILES/securescience/10378/pubMalwareCaseStudy.pdf; classtype:trojan-activity; sid:52007724; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS  (msg:"E5[rb] BLEEDING-EDGE VIRUS PHPInclude.Worm Inbound Attack"; flow: to_server,established; content:"?&cmd=cd%20/tmp\;wget%20"; nocase; content:"perl%20"; nocase; reference:url,www.k-otik.com/exploits/20041225.PhpIncludeWorm.php; classtype:trojan-activity; sid:52001614; rev:12; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any          (msg:"E5[rb] BLEEDING-EDGE VIRUS Zafi.d P2P Infection Attempt (1)"; flow: established; content:"WINAMP 5.7 NEW!.EXE"; nocase; reference:url,www.trendmicro.com/vinfo/virusencyclo/default5.asp?VName=WORM_ZAFI.D; classtype:trojan-activity; sid:52001592; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any          (msg:"E5[rb] BLEEDING-EDGE VIRUS Zafi.d P2P Infection Attempt (2)"; flow: established; content:"ICQ 2005A NEW!.EXE"; nocase; reference:url,www.trendmicro.com/vinfo/virusencyclo/default5.asp?VName=WORM_ZAFI.D; classtype:trojan-activity; sid:52001593; rev:6; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21           (msg:"E5[rb] ET EXPLOIT FTP Serv-U LIST -l Parameter Buffer Overflow"; flow: to_server,established; content:"LIST -l\:"; nocase; isdataat: 134,relative; reference:url,www.securiteam.com/windowsntfocus/5ZP0G2KCKA.html; classtype: misc-activity; sid:52001213; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21           (msg:"E5[rb] ET EXPLOIT FTP Serv-U Local Privilege Escalation Vulnerability"; flow: to_server,established; content:"site exec"; nocase; rawbytes; reference:url,www.securiteam.com/windowsntfocus/5YP0F1FDPO.html; classtype: misc-activity; sid:52001210; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21           (msg:"E5[rb] ET EXPLOIT FTP Serv-U directory traversal vulnerability (1)"; flow: to_server,established; pcre:"/\\[\.]+%20/Bi"; reference:url,www.securiteam.com/windowsntfocus/6C0041F0KO.html; classtype: misc-activity; sid:52001211; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21           (msg:"E5[rb] ET EXPLOIT FTP Serv-U directory traversal vulnerability (2)"; flow: to_server,established; pcre:"/%20[\.]+\//Bi"; reference:url,www.securiteam.com/windowsntfocus/6C0041F0KO.html; classtype: misc-activity; sid:52001212; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21           (msg:"E5[rb] ET EXPLOIT Meteor FTP Server Exploit"; flow:established,to_server; content:"USER"; nocase; offset: 14; pcre:"/USER.{81,}/i"; classtype: misc-activity; reference:url,www.securiteam.com/exploits/5RP0Q2KFPC.html; sid:52001954; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21           (msg:"E5[rb] ET EXPLOIT Wzdftpd SITE command arbitrary command execution attempt"; flow:to_server,established; content:"site"; nocase; pcre:"/site\s+.*?[\;|&]/i"; reference:bugtraq,14935; reference:url,www.securiteam.com/exploits/5CP0R1PGUE.html; classtype:web-application-attack; sid:52002382; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 22           (msg:"E5[rb] ET SCAN LibSSH Based Frequent SSH Connections Likely BruteForce Attack!"; flow:established,to_server; content:"SSH-"; content:"libssh"; within:20; threshold: type both, count 5, seconds 30, track by_src; classtype:attempted-admin; sid:52006546; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 22           (msg:"E5[rb] ET SCAN Potential SSH Scan"; flags:S; threshold: type threshold, track by_src, count 5, seconds 120; classtype: attempted-recon; reference:url,en.wikipedia.org/wiki/Brute_force_attack; sid:52001219; rev:16;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 23           (msg:"E5[rb] ET EXPLOIT Solaris TTYPROMPT environment variable set"; flow: established,to_server; content:"|00 54 54 59 50 52 4F 4D 50 54|"; reference:url,online.securityfocus.com/archive/1/293844; classtype: attempted-admin; sid:52001780; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 23           (msg:"E5[rb] ET EXPLOIT Solaris telnet USER environment vuln Attack inbound"; flow:to_server,established; content: "|ff fa 27 00 00 55 53 45 52 01 2d 66|"; rawbytes; classtype:attempted-user; reference:url,riosec.com/solaris-telnet-0-day; reference:url,isc.sans.org/diary.html?n&storyid=2220; sid:52003411; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 23           (msg:"E5[rb] ET EXPLOIT Solaris telnet USER environment vuln Attack outbound"; flow:to_server,established; content: "|ff fa 27 00 00 55 53 45 52 01 2d 66|"; rawbytes; classtype:attempted-user; reference:url,riosec.com/solaris-telnet-0-day; reference:url,isc.sans.org/diary.html?n&storyid=2220; sid:52003412; rev:2;)
alert tcp $HOME_NET !6661:6668  -> $EXTERNAL_NET any  (msg:"E5[rb] ET ATTACK RESPONSE IRC - Name response on non-std port"; flow: to_client,established; dsize: <128; content:"\:"; offset: 0; depth: 1; content:" 302 "; content:"=+"; content:"@"; tag: session,300,seconds; classtype: trojan-activity; sid:52000346; rev:7;)

############################################################################################################
## SPECIAL PORTS
############################################################################################################
alert tcp $HOME_NET any   -> $EXTERNAL_NET 42     (msg:"E5[rb] REGISTERED FREE EXPLOIT WINS overflow attempt"; flow:to_server,established; byte_test:1,&,64,6; byte_test:1,&,32,6; byte_test:1,&,16,6; byte_test:1,&,8,6; pcre:!"/^.{8}(\x05\x37(\x1E[\x90-\xFF]|[\x1F-\x2F].|\x30[\x00-\x70])|\x00\x00\x00[\x00-\x65]|\x02\x68\x05\xC0)/s"; reference:bugtraq,11763; reference:cve,2004-1080; reference:url,www.immunitysec.com/downloads/instantanea.pdf; reference:url,www.microsoft.com/technet/security/bulletin/MS04-045.mspx; classtype:attempted-admin; sid:53017; rev:6;)
alert tcp $HOME_NET 119   -> $EXTERNAL_NET any    (msg:"E5[rb] COMMUNITY NNTP Lynx overflow attempt"; flow:to_server,established; content:"Subject"; nocase; pcre:"/^Subject\x3a[^\r\n]{100,}/smi"; reference:cve,2005-3120; reference:bugtraq,15117; reference:url,www.osvdb.org/displayvuln.php?osvdb_id=20019; reference:nessus,20035; classtype:attempted-admin; sid:51000172; rev:2;) 
alert tcp $HOME_NET 1863  -> $EXTERNAL_NET any    (msg:"E5[rb] BLEEDING-EDGE WORM General MSN Worm URL Attempt"; flow: established,from_server; content:".php?"; nocase; content:"email="; nocase; within: 5; content:"@"; nocase; within: 20; reference:url,isc.sans.org/diary.php?date=2005-04-13; classtype:attempted-admin; sid:52001247; rev:6; )
alert tcp $HOME_NET any   -> $EXTERNAL_NET 1023   (msg:"E5[rb] COMMUNITY VIRUS Dabber PORT overflow attempt port 1023"; flow:to_server,established,no_stream; content:"PORT"; nocase; isdataat:100,relative; pcre:"/^PORT\s[^\n]{100}/smi"; reference:MCAFEE,125300; classtype:attempted-admin; sid:51000111; rev:1;)
alert tcp $HOME_NET 749   -> $EXTERNAL_NET any    (msg:"E5[rb] REGISTERED FREE ATTACK-RESPONSES successful kadmind buffer overflow attempt"; flow:established,from_server; content:"*GOBBLE*"; depth:8; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:attempted-admin; sid:51900; rev:10;)
alert tcp $HOME_NET 751   -> $EXTERNAL_NET any    (msg:"E5[rb] REGISTERED FREE ATTACK-RESPONSES successful kadmind buffer overflow attempt"; flow:established,from_server; content:"*GOBBLE*"; depth:8; reference:bugtraq,5731; reference:bugtraq,6024; reference:cve,2002-1226; reference:cve,2002-1235; reference:url,www.kb.cert.org/vuls/id/875073; classtype:attempted-admin; sid:51901; rev:10;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 5554   (msg:"E5[rb] ET WORM Sasser FTP exploit attempt"; flow: to_server,established; dsize: >150; content:"PORT "; depth: 5; reference:url,www.lurhq.com/dabber.html; classtype:attempted-admin; sid:52001548; rev:5;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 5554   (msg:"E5[rb] COMMUNITY VIRUS Dabber PORT overflow attempt port 5554"; flow:to_server,established,no_stream; content:"PORT"; nocase; isdataat:100,relative; pcre:"/^PORT\s[^\n]{100}/smi"; reference:MCAFEE,125300; classtype:attempted-admin; sid:51000110; rev:1;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 9090   (msg:"E5[rb] REGISTERED FREE VQServer admin"; flow:to_server,established; content:"GET / HTTP/1.1"; nocase; reference:bugtraq,1610; reference:cve,2000-0766; reference:nessus,10354; reference:url,www.vqsoft.com/vq/server/docs/other/control.html; classtype:attempted-admin; sid:5306; rev:10;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 1000   (msg:"E5[rb] ET WEB WebAdmin User Overflow"; flow:established,to_server; content:"/WebAdmin.dll?"; nocase; content:"User="; nocase; content:!"|0a|"; distance:0; within:200; reference:cve,2003-471; classtype:attempted-user; sid:52002847; rev:2;) 
alert tcp $HOME_NET any   -> $EXTERNAL_NET 143    (msg:"E5[rb] ET EXPLOIT MDAEMON (Post Auth) Remote Root IMAP FETCH Command Universal Exploit"; flow:established,to_server; content:"FLAGS BODY"; pcre:"/[0-9a-zA-Z]{200,}/R"; content:"|EB 06 90 90 8b 11 DC 64 90|"; distance:0; classtype:successful-user; reference:url,www.milw0rm.com/exploits/5248; reference:bugtraq,28245; sid:52008063; rev:1;) 
alert tcp $HOME_NET any   -> $EXTERNAL_NET 2401   (msg:"E5[rb] ET EXPLOIT CVS server heap overflow attempt (target BSD)"; flow: to_server,established; dsize: >512; content:"|45 6e 74 72 79 20 61 61 61 61 61 61 61 61 61 61 61 61|"; offset: 0; depth: 18; threshold: type limit, track by_dst, count 1, seconds 60; classtype: attempted-admin; sid:52000031; rev:4;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 2401   (msg:"E5[rb] ET EXPLOIT CVS server heap overflow attempt (target Linux)"; flow: to_server,established; dsize: >512; content:"|45 6e 74 72 79 20 43 43 43 43 43 43 43 43 43 2f 43 43|"; offset: 0; depth: 20; threshold: type limit, track by_dst, count 1, seconds 60; classtype: attempted-admin; sid:52000048; rev:4;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 2401   (msg:"E5[rb] ET EXPLOIT CVS server heap overflow attempt (target Solaris)"; flow: to_server,established; dsize: >512; content:"|41 72 67 75 6d 65 6e 74 20 62 62 62 62 62 62 62 62 62|"; offset: 0; depth: 18; threshold: type limit, track by_dst, count 1, seconds 60; classtype: attempted-admin; sid:52000049; rev:4;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 3128   (msg:"E5[rb] ET EXPLOIT Squid NTLM Auth Overflow Exploit"; flow: to_server; content:"|4141 414a 4351 6b4a 4351 6b4a 4351 6b4a|"; offset: 96; reference:url,www.idefense.com/application/poi/display?id=107; reference:cve,CAN-2004-0541; classtype: misc-attack; sid:52000342; rev:5;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 4000   (msg:"E5[rb] ET EXPLOIT SecurityGateway 1.0.1 Remote Buffer Overflow"; flow:to_server,established; content:"POST "; depth:5; nocase; content:"/SecurityGateway.dll"; nocase; distance:0; content:"logon"; nocase; distance:0; content:"&username"; nocase; distance:0; pcre:"/\x3d[^\x26]{720}/R"; reference:url,frsirt.com/english/advisories/2008/1717; reference:url,milw0rm.com/exploits/5718; classtype:misc-attack; sid:52008426; rev:2;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 5168   (msg:"E5[rb] ET EXPLOIT TrendMicro ServerProtect Exploit possible worma(little-endian DCERPC Request)"; flow:established,to_server; dsize:>1000; content:"|05|"; depth:1; content:"|10 00 00 00|"; distance:3; within:4; content:"|00 00 88 88 28 25 5b bd d1 11 9d 53 00 80 c8 3a 5c 2c|"; distance:14; within:18; content:"|04 00 03 00|"; distance:0; within:4; content:"|1c 13 74 65|"; distance:500; reference:url,isc.sans.org/diary.html?storyid=3310; classtype:misc-attack; sid:52007584; rev:4;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 617    (msg:"E5[rb] ET EXPLOIT Arkeia full remote access without password or authentication"; flow: from_server,established; content:"|464F3A20596F75206861766520737563|"; content:"|6520636C69656E7420696E666F726D61|"; reference:url,metasploit.com/research/vulns/arkeia_agent; classtype: attempted-admin; sid:52001742; rev:7;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 7144   (msg:"E5[rb] ET EXPLOIT PeerCast Url Overflow"; flow:established,to_server; content:"GET /stream/"; nocase; pcre:"/stream\/\?(.*?=)?[^=]{500}/i"; reference:cve,2006-1148; reference:bugtraq,17040; classtype:attempted-user; sid:52002862; rev:2;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 8300   (msg:"E5[rb] ET WEB MISC Novell GroupWise Messenger Accept Language Buffer Overflow"; flow:established,to_server; content:"Accept-Language"; nocase; pcre:"/^Accept-Language\:[^\n]*?[^,\;\n]{17}/mi"; reference:cve,2006-0992; reference:bugtraq,17503; classtype:attempted-user; sid:52002865; rev:2;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 9999   (msg:"E5[rb] ET EXPLOIT MySQL MaxDB Buffer Overflow"; flow: to_server,established; content:"GET"; content:"|31 c9 83 e9 af d9 ee|"; pcre:"/(GET).\/%.{1586,}/i"; classtype: attempted-admin; sid:52001988; rev:3;)
alert udp $HOME_NET any   -> $EXTERNAL_NET 1434   (msg:"E5[rb] ET SCAN NNG MS02-039 Exploit False Positive Generator - May Conceal A Genuine Attack"; content:"nng Snort (Snort)"; offset:90; threshold:type threshold, track by_dst, count 4, seconds 15; classtype:misc-activity; reference:url,packetstormsecurity.nl/filedesc/nng-4.13r-public.rar.html; sid:52008560; rev:1;)
alert udp $HOME_NET any   -> $EXTERNAL_NET 5060   (msg:"E5[rb] ET EXPLOIT MultiTech SIP UDP Overflow"; content:"INVITE"; nocase; depth:6; isdataat:65,relative; content:!"|0a|"; within:61; reference:cve,2005-4050; classtype:attempted-user; sid:52003237; rev:5;)
alert udp $HOME_NET any   -> $EXTERNAL_NET 5060   (msg:"E5[rb] ET EXPLOIT SIP UDP Softphone INVITE overflow"; dsize:>1000; content:"INVITE"; within:6; nocase; pcre:"/\r?\n\r?\n/R"; isdataat:1000,relative; reference: bugtraq,16213; reference: cve,2006-0189; classtype:attempted-user; sid:52002848; rev:4;) 
alert TCP $HOME_NET any   -> $EXTERNAL_NET 10000  (msg:"E5[rb] ET EXPLOIT Veritas backupexec_agent exploit"; flow:to_server,established; content:"|00 00 00 00 00 00 09 01|"; offset:12; depth:20; content: "|00 00 00 03|"; offset: 28; depth: 32; byte_jump: 4, 32; byte_test: 4,>,3000,0,relative; reference:url,isc.sans.org/diary.php?date=2005-06-27; classtype:misc-attack; sid:52002065; rev:5;)

alert tcp $HOME_NET any   -> $EXTERNAL_NET 8000:8030 (msg:"E5[rb] ET EXPLOIT Nullsoft Shoutcast Server Format String Attack"; flow:established,to_server; content:"GET"; depth:3; nocase; pcre:"/\/content\/.*?%#?\d*[a-z\.].*?\.mp3/Ri"; reference:cve,2004-1373; reference:bugtraq,12096; classtype:web-application-attack; sid:52001751; rev:6;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 6891:6900 (msg:"E5[rb] ET WORM Bropia.F Worm Propagation"; flow: established,to_server; content:"|E1 37 A2 BA 6E 5C 63 8B D6 D1 F7 3C BA 13 16 FD 77 21 5A 5C 17 1B 29 4A 4F 15 A9 29 CF FA 48 3A|"; reference:url,www.trendmicro.com/vinfo/virusencyclo/default5.asp?VName=WORM%5FBROPIA%2EF; classtype: misc-attack; sid:52001715; rev:7;)
alert tcp $HOME_NET any   -> $EXTERNAL_NET 2967:2968 (msg:"E5[rb] ET EXPLOIT Symantec Remote Management RTVScan Exploit"; flow:established,to_server; content:"|10|"; depth:2; content:"|00 24 00|"; distance:0; within:20; content:"|5c|"; distance:0; isdataat:380,relative; reference:cve,2006-3455; reference:url,research.eeye.com/html/advisories/published/AD20060612.html; classtype:attempted-admin; sid:52003250; rev:3;)


############################################################################################################
## NETBIOS EXPLOIT DETECTION
############################################################################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55473; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS DCERPC Messenger Service buffer overflow attempt"; flow:to_server,established;                                    content:"|FF|SMB%"; depth:5; offset:4; nocase; content:"&|00|"; within:2; distance:56; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00|"; within:12; distance:5; nocase; content:"|04 00|"; within:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; reference:bugtraq,8826; reference:cve,2003-0717; reference:nessus,11888; reference:nessus,11890; reference:url,www.microsoft.com/technet/security/bulletin/MS03-043.mspx; classtype:attempted-admin; sid:52258; rev:9;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55482; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55450; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55441; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55476; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55483; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55451; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55444; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55475; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55467; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:53128; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55443; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55474; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55481; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55449; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc LlsrConnect unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"@|FD|,4l<|CE 11 A8 93 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,52,0,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55442; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55536; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55543; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55511; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55504; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55533; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55542; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55510; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55501; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55532; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55541; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55509; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55500; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55548; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55538; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55506; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 llsrpc2 LlsrLicenseRequestW unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|D0|LgW|00|R|CE 11 A8 97 08 00|+.|9C|m"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,www.microsoft.com/technet/security/bulletin/ms05-010.mspx; classtype:attempted-admin; sid:55516; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54806; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54807; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54808; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54809; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54810; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54811; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54812; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54813; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54814; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54815; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54816; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54817; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54818; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54819; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54820; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 locator nsi_binding_lookup_begin unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54821; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55284; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55295; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55247; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55236; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55280; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55289; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55241; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55232; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55282; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55294; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55246; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55234; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55283; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55293; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55245; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 lsass DsRolerUpgradeDownlevelServer unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55235; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54621; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54622; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54623; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54624; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54625; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54626; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54627; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54628; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54629; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54630; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54631; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54632; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54633; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54634; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"+|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,512,4,little,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54635; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 netware_cs function 43 unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|81 B0|z|E6|D|98|!5|9D|2|83|O|03 80 01 C0|"; within:16; distance:22; content:"|00|+"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,512,4,relative; reference:cve,2005-1985; reference:url,www.microsoft.com/technet/security/bulletin/MS05-046.mspx; classtype:attempted-admin; sid:54636; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56881; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56962; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56779; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56833; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56914; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX little endian andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56860; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX little endian andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56998; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX little endian andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56789; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX little endian area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56812; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX little endian callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56950; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX little endian phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56741; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56731; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56901; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56961; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56770; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56853; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56913; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode little endian andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56877; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode little endian andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56971; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode little endian andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56782; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode little endian area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56829; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode little endian callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56923; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode little endian phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56734; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences WriteAndX unicode phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56722; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56886; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56964; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56785; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56838; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56916; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences little endian andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56882; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences little endian andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56970; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences little endian andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56786; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences little endian area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56834; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences little endian callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56922; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences little endian phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56738; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56737; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56865; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56969; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56783; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56817; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,258,0,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56921; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode little endian andx area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56859; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode little endian andx callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56973; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode little endian andx phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56788; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode little endian area/country overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56811; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode little endian callback number overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{68}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,258,0,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56925; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode little endian phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0A 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,little,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56740; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSetUserPreferences unicode phonebook mode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0A|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,34,68,relative; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56735; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56644; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56636; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56588; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56596; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56634; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56666; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56618; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56586; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56649; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56632; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56584; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56601; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56648; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56645; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|0C 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,little,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56597; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 rras RasRpcSubmitRequest unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"6|00|a |22 FA CF 11 98 23 00 A0 C9 11 E5 DF|"; within:16; distance:22; content:"|00 0C|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,8192,4,relative; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,www.microsoft.com/technet/security/bulletin/MS06-025.mspx; classtype:attempted-admin; sid:56600; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54502; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54477; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54493; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54494; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54488; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54486; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54480; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54499; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54501; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54484; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54489; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54498; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54496; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54490; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"F|00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,96,little,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54481; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 spoolss AddPrinterEx unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"xV4|12|4|12 CD AB EF 00 01 23|Eg|89 AB|"; within:16; distance:22; content:"|00|F"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{8})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,96,relative; reference:cve,2005-1984; reference:url,www.microsoft.com/technet/security/bulletin/MS05-043.mspx; classtype:attempted-admin; sid:54500; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55621; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55627; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55595; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55589; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55616; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55622; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55590; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55584; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55619; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55628; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55596; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,1024,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55587; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55618; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55626; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|0F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative,little; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55594; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS v4 winreg OpenKey unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|01 D0 8C|3D|22 F1|1|AA AA 90 00|8|00 10 03|"; within:16; distance:22; content:"|00 0F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:2,>,2048,20,relative; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,www.microsoft.com/technet/security/bulletin/ms00-040.mspx; classtype:attempted-admin; sid:55586; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57262; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57264; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57216; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57214; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57302; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"/"; depth:1; offset:39; byte_jump:2,0,little,relative; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57260; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57212; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize WriteAndX unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB/"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; byte_jump:2,23,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57254; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57294; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57259; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57211; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57246; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize unicode andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57279; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize unicode little endian andx overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57303; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize unicode little endian overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|1F 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57255; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] NETBIOS SMB v4 srvsvc NetrPathCanonicalize unicode overflow attempt"; flow:established,to_server; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/sR"; content:"&|00|"; within:2; distance:29; byte_jump:2,-6,relative,from_beginning,little; pcre:"/^.{4}/sR"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|C8|O2Kp|16 D3 01 12|xZG|BF|n|E1 88|"; within:16; distance:22; content:"|00 1F|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{4}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:cve,2006-3439; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:attempted-admin; sid:57231; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 irot IrotIsRunning little endian overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|02 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,1024,0,little,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:53239; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 irot IrotIsRunning overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|00 02|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,1024,0,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:53238; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 irot IrotRevoke little endian overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|01 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,1024,0,little,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:55328; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 irot IrotRevoke overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|00 01|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,1024,0,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:55325; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 lsass DsRolerUpgradeDownlevelServer little endian overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55303; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 lsass DsRolerUpgradeDownlevelServer overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55304; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 137 (msg:"E5[rb] REGISTERED FREE NETBIOS name query overflow attempt TCP"; flow:to_server,established; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; classtype:attempted-admin; sid:53195; rev:5;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC Messenger Service buffer overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,>,15,2,relative; byte_jump:4,86,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,0,little,relative; reference:bugtraq,8826; reference:cve,2003-0717; reference:nessus,11888; reference:nessus,11890; reference:url,www.microsoft.com/technet/security/bulletin/MS03-043.mspx; classtype:attempted-admin; sid:52257; rev:9;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 irot IrotIsRunning little endian overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|02 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,1024,0,little,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:53257; rev:4;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 irot IrotIsRunning overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|00 02|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,1024,0,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:53256; rev:4;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 irot IrotRevoke little endian overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|01 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,relative,align; byte_test:4,>,1024,0,little,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:55327; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 irot IrotRevoke overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"`|9E E7 B9|R=|CE 11 AA A1 00 00|i|01 29|?"; within:16; distance:22; content:"|00 01|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,relative,align; byte_test:4,>,1024,0,relative; reference:bugtraq,6005; reference:cve,2002-1561; reference:url,www.microsoft.com/technet/security/bulletin/ms03-010.mspx; classtype:attempted-admin; sid:55326; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 lsass DsRolerUpgradeDownlevelServer little endian overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|09 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,little,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55301; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 lsass DsRolerUpgradeDownlevelServer overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"j|28 19|9|0C B1 D0 11 9B A8 00 C0|O|D9|.|F5|"; within:16; distance:22; content:"|00 09|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,0,relative; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,www.microsoft.com/technet/security/bulletin/MS04-011.mspx; classtype:attempted-admin; sid:55306; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS Messenger message little endian overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,&,16,2,relative; content:"|F8 91|{Z|00 FF D0 11 A9 B2 00 C0|O|B6 E6 FC|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; byte_jump:4,18,little,align,relative; byte_jump:4,8,little,align,relative; byte_test:4,>,1024,8,little,relative; reference:bugtraq,8826; reference:cve,2003-0717; classtype:attempted-admin; sid:53234; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS Messenger message overflow attempt"; content:"|04 00|"; depth:2; byte_test:1,!&,16,2,relative; content:"|F8 91|{Z|00 FF D0 11 A9 B2 00 C0|O|B6 E6 FC|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; byte_jump:4,18,align,relative; byte_jump:4,8,align,relative; byte_test:4,>,1024,8,relative; reference:bugtraq,8826; reference:cve,2003-0717; classtype:attempted-admin; sid:53235; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 137 (msg:"E5[rb] REGISTERED FREE NETBIOS name query overflow attempt UDP"; byte_test:1,&,64,2; content:" "; offset:12; isdataat:56,relative; reference:bugtraq,9624; reference:cve,2003-0825; reference:nessus,15912; classtype:attempted-admin; sid:53196; rev:3;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 locator nsi_binding_lookup_begin little endian overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54824; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCADG-IP-UDP v4 locator nsi_binding_lookup_begin overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54825; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 locator nsi_binding_lookup_begin little endian overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,little,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54756; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC NCACN-IP-TCP v4 locator nsi_binding_lookup_begin overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|14 B5 FB D3 3B 0E CB 11 8F AD 08 00|+|1D 29 C3|"; within:16; distance:22; content:"|00 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; byte_test:4,>,256,8,relative; reference:bugtraq,6666; reference:cve,2003-003; reference:url,www.microsoft.com/technet/security/bulletin/MS03-001.mspx; classtype:attempted-admin; sid:54757; rev:1;)

alert tcp $HOME_NET 139 -> $EXTERNAL_NET any (msg:"E5[rb] ET ATTACK RESPONSE Weak Netbios Lanman Auth Challenge Detected"; flow:from_server; content:"|ff 53 4d 42|"; content:"|00 11 22 33 44 55 66 77 88|"; classtype:policy-violation; sid:52006417; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 139 (msg:"E5[rb] ET EXPLOIT NETBIOS SMB DCERPC NetrpPathCanonicalize request (possible MS06-040)"; flow:to_server,established; content:"|00|"; depth:1; content:"|FF|SMB|25|"; depth:5; offset:4; nocase; byte_test:2,^,1,5,relative; content:"&|00|"; within:2; distance:56; content:"|5C|PIPE|5C 00 05 00|"; within:9; distance:4; content:"|1f 00|"; distance:20; within:2; reference:url,www.microsoft.com/technet/security/bulletin/MS06-040.mspx; classtype:misc-attack; sid:52003081; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 139 (msg:"E5[rb] ET EXPLOIT NII Microsoft ASN.1 Library Buffer Overflow Exploit"; flow: to_server,established; content:"|A1 05 23 03 03 01 07|"; reference:url,www.microsoft.com/technet/security/bulletin/ms04-007.asp; classtype: bad-unknown; sid:52000017; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:"E5[rb] ET EXPLOIT LSA exploit"; flow: to_server,established; content:"|313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131|"; offset: 78; depth: 192; classtype: misc-activity; reference:url,www.eeye.com/html/research/advisories/AD20040501.html; reference:url,www.upenn.edu/computing/virus/04/w32.sasser.worm.html; sid:52000032; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:"E5[rb] ET EXPLOIT MS04-007 Kill-Bill ASN1 exploit attempt"; flow: established,to_server; content:"CCCC|20f0fd7f|SVWf"; reference:url,www.phreedom.org/solar/exploits/msasn1-bitstring/; reference:url,www.microsoft.com/technet/security/bulletin/MS04-007.mspx; reference:cve,CAN-2003-0818; classtype:attempted-admin; sid:52001944; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:"E5[rb] ET EXPLOIT MS04011 Lsasrv.dll RPC exploit (Win2k)"; flow: to_server,established; content:"|00 00 00 00 9A A8 40 00 01 00 00 00 00 00 00 00|"; content:"|01 0000 00 00 00 00 00 9A A8 40 00 01 00 00 00|"; classtype: misc-activity; sid:52000046; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 445 (msg:"E5[rb] ET EXPLOIT MS04011 Lsasrv.dll RPC exploit (WinXP)"; flow: to_server,established; content:"|95 14 40 00 03 00 00 00 7C 70 40 00 01|"; content:"|78 85 13 00 AB5B A6 E9 31 31|"; classtype: misc-activity; sid:52000033; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] ET EXPLOIT NTDump Session Established Reg-Entry port 139"; flow: to_server,established; content:"|53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4e 00 74 00 44 00 75 00 6d 00 70 00|"; classtype: misc-activity; sid:52001052; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] ET EXPLOIT NTDump.exe Service Started port 139"; flow: to_server,established; content:"|4e 00 74 00 44 00 75 00 6d 00 70 00 53 00 76 00 63 00 2e 00 65 00 78 00 65 00|"; classtype: misc-activity; sid:52001053; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] ET EXPLOIT Pwdump4 Session Established GetHash port 139"; flow: to_server,established; content:"|50 57 44 75 6d 70 34 2e 64 6c 6c 00 47 65 74 48 61 73 68|"; classtype: suspicious-login; sid:52001753; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] ET EXPLOIT Pwdump3e Session Established Reg-Entry port 139"; flow: to_server,established; content:"|53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 45 00 62 00 69 00 7a 00 5c 00 68 00 61 00 73 00 68|"; classtype: suspicious-login; sid:52000565; rev:7;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] ET EXPLOIT Pwdump3e pwservice.exe Access port 139"; flow: to_server,established; content:"p|00|w|00|s|00|e|00|r|00|v|00|i|00|c|00|e|00|.|00|e|00|x|00|e"; classtype: misc-attack; sid:52000567; rev:7;)
alert tcp $HOME_NET [139,445] -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT Pwdump3e Password Hash Retrieval port 139"; flow: from_server,established; content:"\:|00|5|00|0|00|0\:"; classtype: misc-attack; sid:52000568; rev:8;)

alert udp $HOME_NET 137 -> $EXTERNAL_NET any (msg:"E5[rb] REGISTERED FREE NETBIOS NS lookup response name overflow attempt"; byte_test:1,>,127,2; content:"|00 01|"; depth:2; offset:6; byte_test:1,>,32,12; reference:bugtraq,10333; reference:bugtraq,10334; reference:cve,2004-0444; reference:cve,2004-0445; reference:url,www.eeye.com/html/Research/Advisories/AD20040512A.html; classtype:attempted-admin; sid:52563; rev:4;)

#########################################################################################################
## APPLICATION PORT EXPLOITS
#########################################################################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT v4 msdtc BuildContext heap overflow attempt";  flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|00 01|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,<,37,0,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56456; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT v4 msdtc BuildContextW heap overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|00 07|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,<,37,0,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56447; rev:1;)
alert udp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT-UDP v4 msdtc BuildContextW heap overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|00 07|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,<,37,0,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56450; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT-UDP v4 msdtc BuildContext  heap overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|00 01|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,<,37,0,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56460; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT v4 msdtc BuildContext little endian heap overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|01 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,<,37,0,little,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56459; rev:2;)
alert udp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT-UDP v4 msdtc BuildContext little endian heap overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|01 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,<,37,0,little,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56458; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT v4 msdtc BuildContextW little endian heap overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|07 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,<,37,0,little,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56446; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT v4 msdtc BuildContextW little endian overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|07 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:bugtraq,15056; reference:cve,2005-2119; reference:url,www.microsoft.com/technet/security/bulletin/MS05-051.mspx; classtype:attempted-admin; sid:54249; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT v4 msdtc BuildContextW overflow attempt"; flow:established,to_server; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|00 07|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:bugtraq,15056; reference:cve,2005-2119; reference:url,www.microsoft.com/technet/security/bulletin/MS05-051.mspx; classtype:attempted-admin; sid:54247; rev:3;)
alert udp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT-UDP v4 msdtc BuildContextW overflow attempt"; content:"|04 00|"; byte_test:1,!&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|00 07|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,multiplier 2,relative,align; byte_test:4,>,256,0,relative; reference:bugtraq,15056; reference:cve,2005-2119; reference:url,www.microsoft.com/technet/security/bulletin/MS05-051.mspx; classtype:attempted-admin; sid:54245; rev:4;)
alert udp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT-UDP v4 msdtc BuildContextW little endian overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|07 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,>,256,0,little,relative; reference:bugtraq,15056; reference:cve,2005-2119; reference:url,www.microsoft.com/technet/security/bulletin/MS05-051.mspx; classtype:attempted-admin; sid:54252; rev:4;)
alert udp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC DIRECT-UDP v4 msdtc BuildContextW little endian heap overflow attempt"; content:"|04 00|"; byte_test:1,&,16,2,relative; content:"|E0 0C|k|90 0B C7|g|10 B3 17 00 DD 01 06|b|DA|"; within:16; distance:22; content:"|07 00|"; within:2; distance:28; content:"|00 00|"; within:2; distance:6; pcre:"/^.{2}/sR"; pcre:"/^.{28}(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; pcre:"/^(\x00\x00\x00\x00|.{12})/sR"; byte_jump:4,-4,little,multiplier 2,relative,align; byte_test:4,<,37,0,little,relative; reference:cve,2006-0034; reference:url,www.microsoft.com/technet/security/bulletin/MS06-018.mspx; classtype:attempted-admin; sid:56445; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"E5[rb] ET TROJAN Backdoor.Win32.VB.brg C&C Kill Command Acknowledge"; flow:established,to_server; dsize:29; content:"Status|28 2a|UDP Attack Running!|2a 28|"; offset:0; classtype:trojan-activity; sid:52007981; rev:3;)
alert tcp $HOME_NET !21:23 -> $EXTERNAL_NET any (msg:"E5[rb] REGISTERED FREE ATTACK-RESPONSES Microsoft cmd.exe banner"; flow:established; content:"Microsoft Windows"; content:"|28|C|29| Copyright 1985-"; distance:0; content:"Microsoft Corp."; distance:0; reference:nessus,11633; classtype:attempted-admin; sid:552123; rev:3;)


#########################################################################################################
## ANY ANY Exploits
#########################################################################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET ATTACK RESPONSE Outbound PHP Connection"; flow: established,to_server; content:"From\: anon@anon.com"; nocase; offset: 0; depth: 19; content:"User-Agent\: PHP"; nocase; classtype: web-application-activity; sid:52001628; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT FTP Serv-U Server Long Filename Stack Overflow Vulnerability"; flow: to_server,established; content:"chmod"; nocase; pcre:"/chmod[\s]+([\d]{1,4})*[\s]*[\w\.\/]{250}/Bi"; reference:url,www.securiteam.com/windowsntfocus/5OP0N1PBPG.html; classtype: misc-activity; sid:52001215; rev:8;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT MS04-032 Windows Metafile (.emf) Heap Overflow Connectback Attempt"; flow: established; content:"|45 4D 46|"; content:"|5E 79 72 63|"; content:"|48 4F 44 21|"; reference:url,www.microsoft.com/technet/security/bulletin/ms04-032.mspx; classtype: shellcode-detect; sid:52001364; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT MS04-032 Windows Metafile (.emf) Heap Overflow Exploit"; flow: established; content:"|45 4D 46|"; content:"|EB 12 90 90 90 90 90 90|"; content:"|9e 5c 05 78|"; nocase; reference:url,www.k-otik.com/exploits/20041020.HOD-ms04032-emf-expl2.c.php; classtype: shellcode-detect; sid:52001369; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT MS05-036 exploit - GIF ICC r/b/g/XYZ GetColorProfileElement overflow"; flow:established; content:"ICCRGBG1012"; pcre:"/[rbg]XYZ/"; byte_test:4,!=,20,4,relative,big; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-036.mspx; reference:cve,CVE-2005-1219; classtype:misc-attack; sid:52002137; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT MS05-036 exploit - JPEG ICC r/b/g/XYZ GetColorProfileElement overflow"; flow:established; content:"ICC_PROFILE|00|"; pcre:"/[rbg]XYZ/"; byte_test:4,!=,20,4,relative,big; reference:url,www.microsoft.com/technet/security/Bulletin/MS05-036.mspx; reference:cve,CVE-2005-1219; classtype:misc-attack; sid:52002134; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT Novell ZENWorks for Desktops Remote Heap-Based Buffer Overflow"; flow:to_client,established; content:"CLSID"; nocase; content:"0F517994-A6FA-4F39-BD4B-EC2DF00AEEF1"; distance:0; nocase; content:"CanUninstall"; nocase; classtype:web-application-attack; reference:bugtraq,31435; reference:url,securitytracker.com/alerts/2008/Sep/1020951.html; sid:52008619; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT Possible MS04-032 Windows Metafile (.emf) Heap Overflow Portbind Attempt"; flow: established; content:"|45 4D 46|"; content:"|23 6A 75 4E|"; reference:url,www.microsoft.com/technet/security/bulletin/ms04-032.mspx; classtype: shellcode-detect; sid:52001363; rev:6;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT Possible ShixxNote buffer-overflow + remote shell attempt"; flow: established,to_server; content:"|68 61 63 6b 75|"; offset: 126; depth: 5; content:"|68 61 63 6b 90 61 61 61 61|"; offset: 519; depth: 9; reference:url,aluigi.altervista.org/adv/shixxbof-adv.txt; classtype: shellcode-detect; sid:52001385; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT WMF Exploit"; flow:established; content:"|01 00 09 00 00 03 52 1f 00 00 06 00 3d 00 00 00|"; content:"|00 26 06 0f 00 08 00 ff ff ff ff 01 00 00 00 03 00 00 00 00 00|"; reference:url,www.frsirt.com/exploits/20051228.ie_xp_pfv_metafile.pm.php; classtype:attempted-user; sid:52002734; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT Zilab Chat and Instant Messaging Heap Overflow Vulnerability"; flow:established; content:"|21 00 21 03|"; distance:0; pcre:"/[0-9a-zA-Z]{10,}/"; classtype:misc-attack; reference:url,aluigi.altervista.org/adv/zilabzcsx-adv.txt; reference:bugtraq,27940; sid:52007933; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"E5[rb] ET EXPLOIT Zilab Chat and Instant Messaging User Info BoF Vulnerability"; flow:established; content:"|61 00 09 00 08  00 07 00 21 03|"; distance:0; pcre:"/[0-9a-zA-Z]{10,}/"; classtype:misc-attack; reference:url,aluigi.altervista.org/adv/zilabzcsx-adv.txt; reference:bugtraq,27940; sid:52007934; rev:2;)

###########################################################################################
## FLOWBITS
###########################################################################################

##--------------------------------
## dce.isystemactivator.bind
##--------------------------------
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC ISystemActivator path overflow attempt little endian unicode"; flow:to_server,established; content:"|05|"; depth:1; byte_test:1,&,16,3,relative; content:"|5C 00 5C 00|"; byte_test:4,>,256,-8,little,relative; flowbits:isset,dce.isystemactivator.bind; reference:bugtraq,8205; reference:cve,2003-0352; reference:nessus,11808; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:52351; rev:11;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC ISystemActivator path overflow attempt big endian unicode"; flow:to_server,established; content:"|05|"; depth:1; byte_test:1,<,16,3,relative; content:"|5C 00 5C 00|"; byte_test:4,>,256,-8,relative; flowbits:isset,dce.isystemactivator.bind; reference:bugtraq,8205; reference:cve,2003-0352; reference:nessus,11808; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:52352; rev:10;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC ISystemActivator path overflow attempt big endian"; flow:to_server,established; content:"|05|"; depth:1; byte_test:1,<,16,3,relative; content:"|5C 00 5C 00|"; byte_test:4,>,256,-8,relative; flowbits:isset,dce.isystemactivator.bind; reference:bugtraq,8205; reference:cve,2003-0352; reference:nessus,11808; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53198; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC ISystemActivator path overflow attempt little endian"; flow:to_server,established; content:"|05|"; depth:1; byte_test:1,&,16,3,relative; content:"|5C 5C|"; byte_test:4,>,256,-8,little,relative; flowbits:isset,dce.isystemactivator.bind; reference:bugtraq,8205; reference:cve,2003-0352; reference:nessus,11808; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53197; rev:3;)

##--------------------------------
## smb.tree.bind.nddeapi
##--------------------------------
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 0C|"; within:2; distance:19; isdataat:256,relative; content:!"|00|"; within:256; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52968; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|0C 00|"; within:2; distance:19; isdataat:256,relative; content:!"|00|"; within:256; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52969; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|0C 00|"; within:2; distance:19; isdataat:256,relative; content:!"|00|"; within:256; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52948; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 0C|"; within:2; distance:19; isdataat:256,relative; content:!"|00|"; within:256; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52938; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW unicode andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 0C|"; within:2; distance:19; isdataat:512,relative; content:!"|00 00|"; within:512; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52970; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|0C 00|"; within:2; distance:19; isdataat:512,relative; content:!"|00 00|"; within:512; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52971; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW unicode little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|0C 00|"; within:2; distance:19; isdataat:512,relative; content:!"|00 00|"; within:512; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52949; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB NDdeSetTrustedShareW unicode overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.nddeapi; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-10,relative,from_beginning; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 0C|"; within:2; distance:19; isdataat:512,relative; content:!"|00 00|"; within:512; distance:12; reference:bugtraq,11372; reference:cve,2004-0206; classtype:attempted-admin; sid:52939; rev:4;)

##--------------------------------
## smb.tree.bind.msqueue;
##--------------------------------
alert tcp $HOME_NET any -> $EXTERNAL_NET 135       (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC CoGetInstanceFromFile overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|05|"; depth:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53159; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135       (msg:"E5[rb] REGISTERED FREE NETBIOS DCERPC CoGetInstanceFromFile little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|05|"; depth:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative,little; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53158; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,128,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53188; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,!&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53189; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,128,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53185; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,!&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C|PIPE|5C 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,128,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53184; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile unicode andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,256,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53190; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile unicode little endian andx overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB"; within:4; distance:3; pcre:"/^(\x75|\x2d|\x2f|\x73|\xa2|\x2e|\x24|\x74)/sR"; byte_test:1,&,128,6,relative; content:"%"; depth:1; offset:39; byte_jump:2,0,little,relative; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,256,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53191; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile unicode little endian overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|01 00|"; within:2; distance:19; byte_test:4,>,256,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53187; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET [139,445] (msg:"E5[rb] REGISTERED FREE NETBIOS SMB-DS CoGetInstanceFromFile unicode overflow attempt"; flow:established,to_server; flowbits:isset,smb.tree.bind.msqueue; content:"|00|"; depth:1; content:"|FF|SMB%"; within:5; distance:3; byte_test:1,&,128,6,relative; pcre:"/^.{27}/R"; content:"&|00|"; within:2; distance:29; content:"|5C 00|P|00|I|00|P|00|E|00 5C 00 00 00|"; distance:4; nocase; byte_jump:2,-17,relative,from_beginning,little; pcre:"/^.{4}/R"; content:"|05|"; within:1; byte_test:1,!&,16,3,relative; content:"|00|"; within:1; distance:1; content:"|00 01|"; within:2; distance:19; byte_test:4,>,256,20,relative; reference:cve,2003-0995; reference:url,www.eeye.com/html/Research/Advisories/AD20030910.html; reference:url,www.microsoft.com/technet/security/bulletin/MS03-026.mspx; classtype:attempted-admin; sid:53186; rev:2;)
